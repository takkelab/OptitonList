name: iOS Build

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]
  workflow_dispatch:  # æ‰‹å‹•å®Ÿè¡Œã‚’è¨±å¯

jobs:
  build:
    runs-on: macos-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
          
      - name: Install dependencies
        run: |
          echo "ğŸ“¦ Installing dependencies..."
          npm install
          echo "âœ… Dependencies installed"
        
      - name: Check Node and npm versions
        run: |
          node --version
          npm --version
          
      - name: Build web app
        run: |
          echo "ğŸ”¨ Building web app..."
          npm run build:ci
          echo "âœ… Build completed"
        
      - name: Sync Capacitor
        run: npx cap sync ios
        
      - name: Setup Xcode
        uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: latest-stable
          
      # å°†æ¥çš„ã«è¨¼æ˜æ›¸è¨­å®šå¾Œã€ä»¥ä¸‹ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’è¿½åŠ 
      # - name: Build iOS app
      #   run: |
      #     cd ios/App
      #     xcodebuild -workspace App.xcworkspace \
      #       -scheme App \
      #       -configuration Release \
      #       -destination 'generic/platform=iOS' \
      #       archive -archivePath App.xcarchive
      
      - name: Build summary
        run: |
          echo "âœ… Web build completed"
          echo "âœ… iOS project synced"
          echo "ğŸ“± Next step: Configure signing certificates"
